<html>
	<head>
		<style>
			#network {
				height: 100%;
				width: 100%;
			}

			.links line {
				stroke: #333;
				stroke-opacity: 0.8;
			}

			.nodes circle {
				stroke: #fff;
				stroke-width: 0px;
			}
		</style>
		<script src="https://d3js.org/d3.v4.min.js"></script>
		<script src="https://d3js.org/d3-color.v1.min.js"></script>
		<script src="https://d3js.org/d3-dispatch.v1.min.js"></script>
		<script src="https://d3js.org/d3-ease.v1.min.js"></script>
		<script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
		<script src="https://d3js.org/d3-selection.v1.min.js"></script>
		<script src="https://d3js.org/d3-timer.v1.min.js"></script>
		<script src="https://d3js.org/d3-transition.v1.min.js"></script>
		<script src="https://d3js.org/d3-drag.v1.min.js"></script>
		<script src="https://d3js.org/d3-zoom.v1.min.js"></script>
	</head>
	<body>
		<script>
			var svg = d3.select("body").append("svg")
				.attr("width", "100%")
				.attr("height", "100%")
				.call(d3.zoom().on("zoom", zoom))
				.append("g");

			function zoom() {
				svg.attr("transform", d3.event.transform);
			}

			d3.json('data.json', function (error, graph) {
				if (error) throw error;

				var minX = 0, minY = 0, maxX = 0, maxY = 0;
				var scale = 1;
				var nodes = {};

				graph.nodes.forEach(function (n) {
				  nodes[n.id] = n;
				});

				graph.nodes.forEach(function (n) {
						n.y = -n.y;
						if (n.x < minX) minX = n.x;
						if (n.y < minY) minY = n.y;
						if (n.x > maxX) maxX = n.x;
						if (n.y > maxY) maxY = n.y;
				});

				graph.nodes.forEach(function (n) {
					 	scale = Math.min(1024 / (maxX - minX), 1024 / (maxY - minY));
						n.x = (n.x - minX) * scale;
						n.y = (n.y - minY) * scale;
				});

				var link = svg.append("g")
					.attr("class", "links")
					.selectAll("line")
					.data(graph.edges)
					.enter()
					.append("line")
					.attr("stroke-width", function (d) { return d.value * 2; })
					.attr("x1", function(d) { return nodes[d.sourceID].x; })
					.attr("y1", function(d) { return nodes[d.sourceID].y; })
					.attr("x2", function(d) { return nodes[d.targetID].x ; })
					.attr("y2", function(d) { return nodes[d.targetID].y; });

				var node = svg.append("g")
					.attr("class", "nodes")
					.selectAll("circle")
					.data(graph.nodes)
					.enter()
					.append("circle")
					.attr("r", function (d) { return d.size * scale / 2; })
					.attr("fill", function (d) { return d.color; })
					.attr("cx", function(d) { return d.x; })
					.attr("cy", function(d) { return d.y; })

				node.append("title").text(function (d) { return d.label; });
			});
		</script>
	</body>
</html>
